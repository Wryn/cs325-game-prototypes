<!doctype html> 
<html lang="en"> 
<head> 
	<meta charset="UTF-8" />
	<title>Digital Assignment 1</title>
    <script src="js/phaser.min.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">

var game = new Phaser.Game(640, 480, Phaser.AUTO, '', { preload: preload, create: create, update: update });
var platforms;

function preload() {
    game.load.image('player', "assets/player.png");
    game.load.image('bullet', "assets/bullet.png");
    game.load.image('hole', "assets/hole.png");
    game.load.audio('hit', "assets/hit.ogg");
    
}

function create() {

    game.stage.backgroundColor = '#22AA22';
    gameWon = false;
    score = 0;
    score_display = game.add.text(20, 90, "Score: " + score);
    player = game.add.sprite(320, 400,'player');
    player.anchor.setTo(0.5,0.5);
    game.physics.arcade.enable(player);
    player.body.immovable = true;
    enemy = game.add.sprite(320, 80, 'hole');
    enemy.anchor.setTo(0.5,0.5);
    game.physics.arcade.enable(enemy);
    enemy.body.immovable = true;
    enemy.body.velocity.x = 250;
    hit_sound = game.add.audio('hit');
    hit_sound.play();
    //The following code is adapted from https://gamemechanicexplorer.com/#bullets-2
    SHOT_DELAY = 100; // milliseconds (10 bullets/second)
    BULLET_SPEED = 100; // pixels/second
    NUMBER_OF_BULLETS = 1;
    lastBulletShotAt = 0;
    bulletPool = game.add.group();
    for(var i = 0; i < NUMBER_OF_BULLETS; i++){
        var bullet = game.add.sprite(0, 0, 'bullet');
        bulletPool.add(bullet);
        bullet.anchor.setTo(0.5, 0.5);
        game.physics.enable(bullet, Phaser.Physics.ARCADE);
        bullet.kill();
    }
    //end adapted code
    game.world.bringToTop(player);

}

function update() {

    //The followinng code is adapted from https://gamemechanicexplorer.com/#bullets-4
    game.physics.arcade.collide(enemy, bulletPool, function(enemy, bullet) {
        score += 1;
        score_display.setText("Score: " + score);
        bullet.kill();
    }, null, this);
    //end adapted code

    if(game.input.keyboard.isDown(Phaser.Keyboard.A)){
        if(player.x - 15 > 0) player.x -= 3;
    }
    else if(game.input.keyboard.isDown(Phaser.Keyboard.D)){
        if(player.x + 15 < 640) player.x += 3;
    }
    if(game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)){
        shootBullet();
    }

    if(enemy.x - 15 < 0) enemy.body.velocity.x = 250;
    if(enemy.x + 15 > 640) enemy.body.velocity.x = -250;

    if (score >= 10 && !gameWon) {
        winText = game.add.text(320, 240, "You Win!");
        winText.anchor.setTo(0.5, 0.5);
        timeText = game.add.text(320, 270, (game.time.now / 1000) + "s");
        timeText.anchor.setTo(0.5, 0.5);
        gameWon = true;
    }


}

//The following code is adapted from https://gamemechanicexplorer.com/#bullets-2
function shootBullet(){
    game.world.bringToTop(player);
    if (game.time.now - lastBulletShotAt < SHOT_DELAY) return;
    lastBulletShotAt = game.time.now;
    var bullet = bulletPool.getFirstDead();
    if (bullet === null || bullet === undefined) return;
    hit_sound.restart();
    bullet.revive();
    bullet.checkWorldBounds = true;
    bullet.outOfBoundsKill = true;
    bullet.reset(player.x, player.y);
    bullet.body.velocity.y = (-1) * BULLET_SPEED;
    bullet.body.velocity.x = 0;
}
//end adapted code

</script>

<div id="game"></div>
<div id="readme">
<h2>Golf Shooter</h2>

<ul>
<li><strong>Originality:</strong>
I don't know many golf games that make you shoot the balls into the hole like a top down shooter while the hole is moving back and forth.
</li>

<li><strong>Technical Merit:</strong>
Not sure really. Things move and bullets do stuff when they collide.
</li>

<li><strong>Prototype Postmortem:</strong>
I learned how to make sprites and how to get bullets to shoot and collide. The hardest part was getting phaser to work.
</li>

<li><strong>Prototype Assets:</strong>
I used GIMP and drew all my images.
Golf ball sound is from <a href=https://www.youtube.com/watch?v=mAmxRBXZH84>here</a>.
</li>
<ul>
</ul>
</li>

<li><strong>Prototype Closest Other Game:</strong>
I borrowed the bullet code from gamemechanincexplorer.com, but besides that I didn't look at/borrow from any phaser examples to my knowledge.
</li>

<li><strong>High Concept:</strong>
Shoot golf balls into the moving hole to try and score 10 points as fast as possible.
</li>

<li><strong>Theme:</strong>
Golfer
</li>

<li><strong>Mandated Variety:</strong>
N/A
</li>

<li><strong>Prototype Goal:</strong>
Shooting bullets
</li>

<li><strong>Player Experience Goals:</strong>
What it feels to shoot golf balls into a hole. Honestly, I wanted to make a bullet hell game but that's quite a bit of work and didn't have time this week.
</li>

<li><strong>Gameplay:</strong>
A player can move around the screen using the AD keys (A - Left, D - Right)
They can shoot by holding down Space.
</li>

<li><strong>Strategies:</strong>
Shooting ahead of where the hole moves and finding a place you're comfortable with.
</li>

<li><strong>Story/Setting/Premise:</strong>
Just a person who likes to golf.
</li>

<li><strong>Target Audience:</strong>
People who like 2d shooting games.
</li>

<li><strong>Play Time:</strong>
Around a minute or two.
</li>

</ul>

</div>
</body>
</html>